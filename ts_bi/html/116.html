
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
[<div class="message-content editor-style">
<h2 id="articleHeader1">基本概念</h2><p>1. Set  - 元组的集合，在 Set 中的元组用逗号分开，Set 以花括号括起来，例如：</p><pre><code><span style='font-family: "Microsoft Yahei";'>{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
}</span></code></pre><p>从这个例子中可以看到Set的几个特点：</p><ul><li>一个Set 中可以包含一个或者多个 Tuple 元组</li><li>在 Set 中的每一个元组所包含的Member 成员都对应的引用的是同一个层次结构，在这个例子中引用的是 [Product].[Category]</li></ul><p>这种也是Set</p><pre><code><span style='font-family: "Microsoft Yahei";'>{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>. <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2001</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
}</span></code></pre><p>从这里可以看到 Set：</p><ul><li>在包含的元组中，元组中的成员可以有一个或者多个，但是元组中的成员顺序和其它元组中成员的顺序应该相同。这里所讲的成员是指在Set中所有元组中第一个成员引用的层次结构都是 [Product].[Category] 并且第二个成员引用的都是 [Date].[Calendar] 属性层次结构。成员引用属性层次结构的顺序不能改变，必须相同。</li></ul><p>2. 案例分析 – 查询 Accessories，Bikes，Clothing，Components 四类产品在2002-2004 财年美国的零售额。行轴为四类产品，列轴为 2002-2004 财年+美国</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span></span></code></pre><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15125300-6589816cba1c49fab0735b8d3d548cd4.png"/></p><p>第一个 Set 中包含了三个元组，每一个元组都包含两个成员引用，第一个成员引用财年层次结构，第二个成员引用了地理纬度中的国家层次结构。第二个 Set 包含了四个元组，每一个元组都只包含一个成员，但是都引用到了同一个Category 层次结构。</p><p><strong><span style="color: rgb(255, 0, 0);">错误的引用:</span></strong></p><ol><li><span style="color: rgb(255, 0, 0);">元组中的成员引用了不一致的层次结构</span></li></ol><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            <span style="background-color: rgb(255, 255, 0);">(</span><span style="background-color: rgb(255, 255, 0);"><span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Subcategory</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Mountain Bikes</span><span style="color: rgb(255, 0, 0);">]</span></span><span style="background-color: rgb(255, 255, 0);">)</span><br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span></span></code></pre><p>错误消息: <span style="color: rgb(255, 0, 0);">Executing the query...</span></p><p><span style="color: rgb(255, 0, 0);">Members，tuples or sets must use the same hierarchies in the function.</span></p><p><span style="color: rgb(255, 0, 0);">Execution complete</span></p><p>解释 - 第二个Set 中的元组 ([Product].[Subcategory].[Mountain Bikes]) 中的成员所引用的层次结构和其它元组中的成员所引用的层次结构不一致，导致错误。  </p><p>2.<span style="color: rgb(255, 0, 0);"> 元组中的成员在引用层次结构时的顺序不一致</span></p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
   (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
   (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
   (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
   (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
   (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
   (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
   (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
   (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Mountain Bikes</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span></span></code></pre><p>错误消息：</p><p><span style="color: rgb(255, 0, 0);">Executing the query...</span></p><p><span style="color: rgb(255, 0, 0);">Members，tuples or sets must use the same hierarchies in the function.</span></p><p><span style="color: rgb(255, 0, 0);">Execution complete</span></p><p>解释：第一个 Set 中的第一个元组中的成员引用的层次结构顺序和第二个第三个元组中的成员引用的属性层次结构不一致，顺序不能颠倒，必须保持完全一致。</p><p>3. <span style="color: rgb(255, 0, 0);">重复的元组是允许的，这样查询出来的结果就会多一条记录</span></p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Mountain Bikes</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span></span></code></pre><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15125325-367dbc457642467e8432ae28e51183aa.png"/></p><p>3. Distinct 函数</p><p>在一个有着复杂逻辑的MDX 查询中很有可能在一个 Set 中出现重复的元组，可以通过Distinct 函数去掉重复的元组 Distinct({Set})</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
            (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
<span style="color: rgb(0, 0, 255);">DISTINCT</span>(<br/>
            {<br/>
                (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
                (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
                (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
                (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
                (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
                (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product Categories</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Mountain Bikes</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
            }<br/>
) <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span></span></code></pre><p> 查询结果</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15125333-fbfa970df7c440ae815760205f1af5b4.png"/></p><p>4. 理解 SELECT  Understanding the SELECT statement</p><p>SELECT 语句的目的是定义新的 Cube 空间，新的Cube 空间是由类似于 COLUMNS或者ROWS 这样的轴组成，在这些轴上的点都是由Set里元组中的成员或者成员的组合组成的。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15134224-70143c185e8542439ff0349b1261c6f0.png"/>                    </p><p>在这个图中，由 Calendar Year 和 Country 两个层次结构中的成员构成了一个元组 Tuple，三个这样的Tuple 构成了一个 SET，用这个 SET 描述了一个 COLUMNS 的轴。 这个轴其实是一个平面，是由Calendar Year 和 Country 两个属性层次结构形成的平面。另外的一个 SET 中，由四个 Category 成员元组形成了另外的一个 ROWS 轴。这两个轴形成了一个两维空间，而这个空间平面上的点都是由这两个轴交叉的点组成的。</p><p>之前第三章我们描述这样的交叉都是在元组Tuple 中定义的，例如像本示例提到的 构成COLUMNS 轴上的 [CY2002]和[United States] 再加上 ROWS 轴上的  [Accessories] 实际上就这一个交叉点用元组 Tuple 来表示的话就应该是:</p><p>([CY2002]，[United States]，[Accessories])</p><p>那么这个元组实际上还是一个局部元组，按照第三章的理解(请查看第三章我的学习笔记 <a href="http://www.cnblogs.com/biwork/archive/2013/04/09/3010199.html"> http://www.cnblogs.com/biwork/archive/2013/04/09/3010199.html</a>)</p><p>SSAS还会对这个局部元组还会对其它未能显示列出的轴自动按照一定规则自动补齐，所以上面的示例中哪些交叉点不仅仅是这三个轴的交叉点，而且也应该包含了其它属性层次结构作为轴时的交叉点，比如默认的 Reseller Sales 度量值纬度。</p><p>就这个例子，可以忽略这种局部元组的说法，可以认为两个轴 [Date].[Calendar] 和 [Geography].[Country] 合起来构成了一个面，而这个面又作为一个新的轴存在并以 COLUMNS 的形式出现，[Product].[Category] 这一个属性层次结构构成了一个单独的轴以 ROWS 的形式出现。很自然的理解，COLUMNS 出现在查询结果的列的位置，而 ROWS 出现在行的位置，行和列的交集就形成了各个 Tuple ，然后按照第三章的规则获取各个Tuple 最终定位的值。</p><p>通过这个例子可以发现：</p><p>有三个属性层次结构被显示写出，[Date].[Calendar] 属性层次结构有3个成员，[Geography].[Country] 有1个成员，所以3*1 这两个轴先构成了一个面。然后再加上 [Product].[Category] 轴有4个成员，所以 3*4 就构成了12个点，这12个点构成了一个查询集合。</p><p>5. 带有Where 条件的 Slicer Axis (切片轴)</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15163636-e29cdb0d2c264e93898f94984af3dd6c.png"/></p><p>书上通过两个例子来讲解其中的区别：</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>，<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span></span></code></pre><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15163702-ee7f153e66ed4ea3b7372e09d611db9b.png"/></p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span><br/>
<span style="color: rgb(0, 0, 255);">WHERE</span> (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)</span></code></pre><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15163710-8cc1defe6016492eae43678de6e61a9c.png"/></p><p>从这两个对比能够看出他们之间相同的地方和区别：</p><p>相同的地方就是查询结果都是一样的。</p><p>不同的地方就是第一个查询中,由于([Geography].[Country].[United States])是第一个 SET 中组成Tuple的一个元素，因此会作为 COLUMNS 的一部分显示在列头。</p><p>6. SELECT  语句中的轴</p><p>SELECT 语句最多可以支持 128 个轴，轴的序号从 0 ~ 127，但是基本上我们不会使用的到那么多，一般只使用前两个，即我们常用的 COLUMNS 和 SETS。因为大多数客户端工具只能支持到二维即显示行和列。并且是使用这些轴的名称的时候，他们的顺序必须是连续的. 即如果写了 ROWS，那么COLUMNS 也必须存在 ，不能只使用 ROWS 而不使用COLUMNS。</p><p>下图中显示了前5个轴的正式名称，短名称和别名。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15174455-74cc02a113bc4e4ba197bc2a47c48b6c.png"/></p><p>这样写不会有问题，但是为了方便阅读最好还是使用 COLUMNS 和 ROWS 的形式</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
       {<br/>
              (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
       } <span style="color: rgb(0, 0, 255);">ON</span> AXIS(<span style="color: rgb(128, 0, 0); font-weight: bold;">0</span>),<br/>
       {<br/>
              (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
       }<span style="color: rgb(0, 0, 255);">ON</span> <span style="color: rgb(128, 0, 0); font-weight: bold;">1</span><br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span>;</span></code></pre><p>7. Members 函数的使用</p><p>Members 函数使用的频率非常高，又没有任何参数，使用它主要是为了从属性层次结构或者属性层次结构某一层中取出所有的成员。</p><p>[Dimension].[Hierarchy].Members</p><p>[Dimension].[Hierarchy].[Level].Members</p><p>如果某一个Hierarchy 层次结构没有指定特别的Level时，Members 函数就会返回包含 ALL 以内的所有成员。如果指定了特定的Level，那么就只有这个层次结构Level 上的成员被返回。</p><p>另外要注意的是，Members 函数返回的是一个成员的集合(Set) {…}，集合本身是由 Tuple 元组(..),(..)构成的，而元组里面的内容是成员[…].[…].[…].  那么在Members 返回这些成员时，会为每一个成员自动的包装到一个一个的Tuple中，最后所有的Tuple 组成一个集合。</p><p>Members 函数查询一示例</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span><br/>
<span style="color: rgb(0, 0, 255);">WHERE</span> (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)</span></code></pre><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15212709-3c4c305deb9d490784091a85f60fdb4d.jpg"/></p><p>在这个查询中，ROWS 轴上引用了 Product纬度的 Category层次结构中的四个成员，看看这个结构，先把这些概念分清楚。这也是我之前一直不能理解的东西，分不清楚为什么在 Members 下面能看到 Accessories，Bikes，Clothing，Components 然后在Category 下面也看到这些东西。</p><h2 id="articleHeader2">Product 维度的层次结构与成员</h2><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15182604-030bd756ddcd4f2e9bde3cebe1183f20.png"/></p><p>首先看 Product，这个是纬度的名称，通常就说做 Product 纬度。</p><p>六个方格表示的 Category 是属性层次结构，换个空间表述它，它就是多维空间中的一个轴。在这里，我们提到的纬度中的属性层次结构一般包含有两个级别，第一个级别是 ALL，第二个级别是具体的成员。</p><p>ALL 的作用就是保存聚合了 Accessories，Bikes，Clothing，Components这些成员 的值，所以能看到 [All Products] 这个元素在其它四个子成员之上而位于Category hierarchy 之下。</p><p>最下面的Category 表示一个Level，这个Level 很显然在层次结构中位于 ALL 之下，那么所有 ALL 之下的成员就归到这个Level 中在下面一一列出来。所以这里的 Category 不能像 All Products一样表示的是一个成员，而应该是一个Level。</p><p>了解了这些之后，我们通过以下这些例子来看看Members 函数使用的效果。</p><p>Members 函数查询二示例</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
(<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
(<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
(<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
　<span style="font-family: 'Courier New';">--[Product].[Category].[Category]</span>  <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.MEMBERS<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span><br/>
<span style="color: rgb(0, 0, 255);">WHERE</span> (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)</span></code></pre><p>这个查询等同于 Members 函数查询一示例，<span style="color: rgb(255, 0, 0);"><span style="color: rgb(0, 0, 0);">将这个引用分解下 </span>[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.MEMBERS<br/></p><p>[Product 维度].[Category 层次结构].[Category Level].MEMBERS 那么对应上面的Product维度树 Category Level 下的所有成员就是示例一中的那些成员。</p><p>也可以写成 [Product].[Category].[Category] 默认情况下也访问到 Category Level 下的所有成员。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15214427-20532959579c40da8d1a1be89f8bc450.jpg"/></p><p>更进一步看这个查询</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
   <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">All Products</span><span style="color: rgb(255, 0, 0);">]</span><br/>
　　--    <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category]</span> } <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span><br/>
<span style="color: rgb(0, 0, 255);">WHERE</span> (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)</br></span></code></pre><p>这里的 [All Products] 指的不是 Category 下的包括 ALL 的所有成员，而是指 ALL 这一个成员。</p><p>也可以省略掉 [All Products] 而直接写成 [Product].[Category] 因为这样只有 维度.层次结构 的情况下默认也是访问 ALL 这个成员，除非 ALL 这个成员被设置为隐藏不可见。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15214809-0b74eda3004e4d3a8b9a8d096f8e074a.jpg"/></p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{<br/>
   <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.MEMBERS<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span><br/>
<span style="color: rgb(0, 0, 255);">WHERE</span> (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)</span></code></pre><p><span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.MEMBERS  才表示包括了 ALL 这个成员的所有成员</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15214952-9328573b258f4042b40c7535514d8261.jpg"/></p><p> 8. MeasureGroupMeasures 函数的使用</p><p>返回某一个 Measure 组中所有的度量值(非计算)</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.Members} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
{MeasureGroupMeasures("Reseller Sales")} <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span></span></code></pre><p><img alt="" height="365" src="http://images.cnitblog.com/blog/477275/201304/15220627-37a0aba7601f48168ccbdf33aa720fcd.jpg" width="804"/></p><p>9. CrossJoin 函数</p><p>CrossJoin 函数的作用是可以让一个Set中的所有元祖Tuple 与另外的一个Set中的所有元祖形成一个交叉组合。</p><p>语法 - Crossjoin( {Set1}，{Set2} [，. . . {Setn} )</p><p>CrossJoin 里可以有两个或者两个以上的 SET 作为参数，并且在 SSAS 中可以使用 * 来代替 Crossjoin这个关键字。</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS,<br/>
Crossjoin(<br/>
    {<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.Members}，<span style="color: rgb(0, 128, 128);">--</span><span style="color: rgb(0, 128, 128);"> 1 Member Cross Join 2 Measures</span><br/>
    {<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Sales Amount</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Order Quantity</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
    }<br/>
) <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span><br/>
<span style="color: rgb(0, 0, 255);">WHERE</span> (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)</span></code></pre><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/15221526-c6b621cb0f654e9e8d17c9d28e442294.jpg"/></p><p>Category Level 下有四个成员 Accessories，Bikes，Clothing，Components 通过与 [Measures] 下的两个成员 Reseller Sales Amount 和 Reseller Order Quantity 交叉连接后，其实就变成了这样的 MDX 查询，查询的结果和上面的示例是一样的。</p><p>注意这里的 Measures 也是一个维度，但这个维度比较特殊，它是度量值维度也叫事实维度，它不同于其它的维度，度量值维度是没有 ALL 这个成员的。</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br/>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS，<br/>
    {<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Sales Amount</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Accessories</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Order Quantity</span><span style="color: rgb(255, 0, 0);">]</span>)，<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Sales Amount</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Bikes</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Order Quantity</span><span style="color: rgb(255, 0, 0);">]</span>)，<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Sales Amount</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Clothing</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Order Quantity</span><span style="color: rgb(255, 0, 0);">]</span>)，<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Sales Amount</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Components</span><span style="color: rgb(255, 0, 0);">]</span>,<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Order Quantity</span><span style="color: rgb(255, 0, 0);">]</span>)  <br/>
    }<br/>
<span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span><br/>
<span style="color: rgb(0, 0, 255);">WHERE</span> (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)</span></code></pre><p>上面的代码又可以回到第三章的 Partial Tuple 局部元组，理解一下它们在空间中的定位。<br/></p><p>CROSSJOIN 也可以用 * 运算符代替，语法是 {SET1} * {SET 2} * {SET..}</p><pre><code><span style='font-family: "Microsoft Yahei";'><span style="color: rgb(0, 0, 255);">SELECT</span><br>
{<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2002</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2003</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
    (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Date</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Calendar</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">CY 2004</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
} <span style="color: rgb(0, 0, 255);">ON</span> COLUMNS，<br/>
    {<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Product</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Category</span><span style="color: rgb(255, 0, 0);">]</span>.MEMBERS } <span style="color: rgb(0, 128, 128);">--</span><span style="color: rgb(0, 128, 128);"> SET 1</span><br/>
    <span style="color: rgb(128, 128, 128);">*</span><br/>
    {<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Sales Amount</span><span style="color: rgb(255, 0, 0);">]</span>),<br/>
        (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Measures</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Reseller Order Quantity</span><span style="color: rgb(255, 0, 0);">]</span>)<br/>
    } <span style="color: rgb(0, 128, 128);">--</span><span style="color: rgb(0, 128, 128);"> SET 2</span><br/>
  <span style="color: rgb(0, 0, 255);">ON</span> ROWS<br/>
<span style="color: rgb(0, 0, 255);">FROM</span> <span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Step-by-Step</span><span style="color: rgb(255, 0, 0);">]</span><br/>
<span style="color: rgb(0, 0, 255);">WHERE</span> (<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Geography</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">Country</span><span style="color: rgb(255, 0, 0);">]</span>.<span style="color: rgb(255, 0, 0);">[</span><span style="color: rgb(255, 0, 0);">United States</span><span style="color: rgb(255, 0, 0);">]</span>)</br></span></code></pre>
</div>]
</body>
</html>
