
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
[<div class="message-content editor-style">
<p>1. 大多数表达式会返回数值类型的值，但是也能返回例如字符串，时间，布尔或者其它类型的值。</p><p>2. 一般表达式的结果都是几个值通过操作符运算后得到的，下列表格中显示了对比，逻辑的，数值的，字符串以及集合操作符。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/18180453-639d93314748427fac15d93e18839e69.png"/></p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/18180504-f20be2808f004d2b818f043013dcd239.png"/></p><p>3. SSAS 中的 VBA 函数</p><p> <img alt="" src="http://images.cnitblog.com/blog/477275/201304/18180530-7c8a39f0e31f45b9b7062a0ad85e1b2f.png"/></p><p>4. Calculated Members 计算成员</p><p>可以把计算成员当成已存在的属性或者层次结构的一个成员，但是计算成员又和其它的传统成员不同，它并不会把值保存在 Cube空间里。</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code><span style="color: #0000ff;">WITH</span><br/>
MEMBER <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">X</span><span style="color: #ff0000;">]</span> <span style="color: #0000ff;">AS</span><br/>
<span style="color: #800000; font-weight: bold;">1</span><span style="color: #808080;">+</span><span style="color: #800000; font-weight: bold;">1</span><br/>
<span style="color: #0000ff;">SELECT</span><br/>
{<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>),<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2004</span><span style="color: #ff0000;">]</span>)<br/>
} <span style="color: #0000ff;">ON</span> COLUMNS,<br/>
{<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Accessories</span><span style="color: #ff0000;">]</span>) ,<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Bikes</span><span style="color: #ff0000;">]</span>),<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Clothing</span><span style="color: #ff0000;">]</span>),<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Components</span><span style="color: #ff0000;">]</span>),<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">X</span><span style="color: #ff0000;">]</span>)<br/>
} <span style="color: #0000ff;">ON</span> ROWS<br/>
<span style="color: #0000ff;">FROM</span> <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Step-by-Step</span><span style="color: #ff0000;">]</span>;</code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/18180656-c4145d5e26504133a5c24e4a687f1076.png"/></p><p>这是一个计算成员的示例，在Cube 中的任何成员都必须依附于某一个层次结构，可以是纬度层次结构也可以是度量值层次结构。</p><p>这个例子中，计算成员 X 被定义为 Product 纬度 Category 属性层次结构中的一个成员，表达式 1+1 赋予给这个计算成员，结果为2。</p><p>但是要注意，如果使用 Members 函数，那么某个纬度下的计算成员将不会出现：</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code><span style="color: #0000ff;">WITH</span><br/>
MEMBER <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">X</span><span style="color: #ff0000;">]</span> <span style="color: #0000ff;">AS</span><br/>
<span style="color: #800000; font-weight: bold;">1</span><span style="color: #808080;">+</span><span style="color: #800000; font-weight: bold;">1</span><br/>
<span style="color: #0000ff;">SELECT</span><br/>
{<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>),<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2004</span><span style="color: #ff0000;">]</span>)<br/>
} <span style="color: #0000ff;">ON</span> COLUMNS,<br/>
{<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.Members} <span style="color: #0000ff;">ON</span> ROWS<br/>
<span style="color: #0000ff;">FROM</span> <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Step-by-Step</span><span style="color: #ff0000;">]</span></code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/18180755-a1dbf41692734051b34cb4c139d5dec1.png"/></p><p>这时就要使用 ALLMembers 函数来同时显示成员和计算成员。</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code><span style="color: #0000ff;">WITH</span><br/>
MEMBER <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">X</span><span style="color: #ff0000;">]</span> <span style="color: #0000ff;">AS</span><br/>
<span style="color: #800000; font-weight: bold;">1</span><span style="color: #808080;">+</span><span style="color: #800000; font-weight: bold;">1</span><br/>
<span style="color: #0000ff;">SELECT</span><br/>
{<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>),<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2004</span><span style="color: #ff0000;">]</span>)<br/>
} <span style="color: #0000ff;">ON</span> COLUMNS,<br/>
{<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.AllMembers} <span style="color: #0000ff;">ON</span> ROWS<br/>
<span style="color: #0000ff;">FROM</span> <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Step-by-Step</span><span style="color: #ff0000;">]</span></code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/18180834-1dcc9a2f6dde4a158208123501c410b8.png"/></p><p>另外，现在看到的计算成员的使用范围还是属于当前查询范围的，只能在当前查询语句中使用。</p><p><strong>动态表达式</strong></p><p><strong>示例一</strong></p><p>在 Product 纬度下层次结构中添加一个新的计算成员，这个计算成员由一个元组和一个常量相加形成一个表达式。</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code><span style="color: #0000ff;">WITH</span><br/>
MEMBER <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">X</span><span style="color: #ff0000;">]</span> <span style="color: #0000ff;">AS</span><br/>
(<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Bikes</span><span style="color: #ff0000;">]</span>)<span style="color: #808080;">+</span><span style="color: #800000; font-weight: bold;">1</span><br/>
<span style="color: #0000ff;">SELECT</span><br/>
{<br/>
            (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>),<br/>
            (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2004</span><span style="color: #ff0000;">]</span>)<br/>
} <span style="color: #0000ff;">ON</span> COLUMNS,<br/>
{<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.AllMembers} <span style="color: #0000ff;">ON</span> ROWS<br/>
<span style="color: #0000ff;">FROM</span> <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Step-by-Step</span><span style="color: #ff0000;">]</span>;</code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p>X 的值是 Bikes 在 2003 和 2004年的值+1。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/18180930-6317f2f25d17419791b2a21cca5db14f.png"/></p><p><strong>示例二</strong></p><p>还是在 Product 纬度下的层次结构中添加一个新的成员<strong>Bikes &amp; Accessories， </strong>在它的表达式中由两个 Category 的成员相加组成，即两个元组参与了相加的运算。这个两个元组一个是引用了 Bikes 这个成员，另一个是引用了 Accessories 这个成员。</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code><span style="color: #0000ff;">WITH</span><br/>
MEMBER <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Bikes &amp; Accessories</span><span style="color: #ff0000;">]</span> <span style="color: #0000ff;">AS</span><br/>
(<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Bikes</span><span style="color: #ff0000;">]</span>) <span style="color: #808080;">+</span> (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Accessories</span><span style="color: #ff0000;">]</span>)<br/>
<span style="color: #0000ff;">SELECT</span><br/>
{<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>),<br/>
    (<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2004</span><span style="color: #ff0000;">]</span>)<br/>
} <span style="color: #0000ff;">ON</span> COLUMNS,<br/>
{<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.AllMembers} <span style="color: #0000ff;">ON</span> ROWS<br/>
<span style="color: #0000ff;">FROM</span> <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Step-by-Step</span><span style="color: #ff0000;">]</span></code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/18181017-1f436bb6d456437d88e3c0cda1d8a892.png"/></p><p>查询的结果可以看到 <strong>Bikes &amp; Accessories </strong>在2003年和2004年的值等于 Bikes 和 Accessories在2003年和2004年相加的结果。</p><p>下面分析一下 SSAS 是如何解析这个计算成员的，并且是如何动态赋值的。</p><p>由于我们已经定义了这个计算成员成为 Category 属性层次结构中的一个成员，那么在使用{[Product].[Category].AllMembers 时就能够访问到这个计算成员。我们考虑一下比如 [Date].[Calendar Year].[CY 2003] 成员 和 [Product].[Category].[All Products].[<strong>Bikes &amp; Accessories</strong>] 这个成员形成的一个交叉点，实际上就是一个单元格或者也可以理解为一个局部元组 –</p><p>([Date].[Calendar Year].[CY 2003], [Product].[Category].[All Products].[<strong>Bikes &amp; Accessories</strong>])  SSAS 会按照3个填充局部元组的规则对这个元组进行填充。(需要了解填充局部元组规则的请参看第三章学习笔记)</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201304/18181051-2befd7d31fe54fde83c2de5855589774.png"/> </p><p>填充这个局部元组的过程参照上图，最终会得到一个完整的元组 (假设当前环境下只有这几个纬度和层次结构的情况下）。</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code>(<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Fiscal Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Periods</span><span style="color: #ff0000;">]</span>,<br/>
    <strong><span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Bikes &amp; Accessories</span><span style="color: #ff0000;">]</span>,<br/>
    </strong><span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Subcategory</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Measures</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Reseller Sales Amount</span><span style="color: #ff0000;">]</span>        <br/>
)</code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p>但是这个完整的元组包含了一个计算成员 <strong>[Product].[Category].[Bikes &amp; Accessories] </strong>因此在实际的Cube 空间里是找不到和它对应的一个点或者一个实际存储有值的那个单元格。那么这时 SSAS 就需要应用表达式获取它的值。</p><p>由于这个表达式包含了两个局部元组</p><p>([Product].[Category].[Bikes]) 和 ([Product].[Category].[Accessories])，<span style="color: rgb(255, 0, 0);">为了补充这两个局部元组，SSAS 不再像之前一样按照规则进行补充，而是从当前的那个已经完成的元组中直接去引用其它成员来实现一个完整的元组。换一个角度来说，当前这个完整的元组为计算成员中出现的元组提供了上下文环境，供其直接引用当前环境的其它成员。</span></p><p><span style="color: rgb(255, 0, 0);"><strong>有一点非常重要就是，这两个局部元组只会引用自己所没有的层次结构的其它成员，因此在填充它们自己的元组时因为 [Product].[Category].[Bikes &amp; Accessories]和他们同属一个层次结构，他们已经同在一个轴上，因此将不会再去引用。</strong></span></p><p>对于局部元组 ([Product].[Category].[Bikes]) 而言，对它进行填充的后得到一个完整的元组可以在空间上具体定位到一个点。</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code>(<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Fiscal Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Periods</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Bikes</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Subcategory</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Measures</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Reseller Sales Amount</span><span style="color: #ff0000;">]</span>        <br/>
)</code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p>对于局部元组 ([Product].[Category].[ Accessories]) 而言，对它进行填充的后得到一个完整的元组可以在空间上具体定位到一个点。</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code>(<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Fiscal Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Periods</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;"> Accessories</span><span style="color: #ff0000;">]</span> ,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Subcategory</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Measures</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Reseller Sales Amount</span><span style="color: #ff0000;">]</span>        <br/>
)</code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p>这样两个完整的元组所表示的值通过操作符 + 相加，就能得到一个结果，这个结果就是计算成员的结果。</p><p>因此像这样把 CY 2003 改称 CY 2002</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code>(<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2002</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Fiscal Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Periods</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Bikes &amp; Accessories</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Subcategory</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Measures</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Reseller Sales Amount</span><span style="color: #ff0000;">]</span>        <br/>
)</code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p>那么 SSAS 在解析它时实际上也就变成了这两个值相加的结果</p><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><pre><code>(<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2002</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Fiscal Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Periods</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Bikes</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Subcategory</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Measures</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Reseller Sales Amount</span><span style="color: #ff0000;">]</span>        <br/>
)<br/>
<span style="color: #808080;">+</span><br/>
(<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Calendar Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">CY 2003</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Date</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Fiscal Year</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Periods</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Category</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;"> Accessories</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Product</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Subcategory</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">All Products</span><span style="color: #ff0000;">]</span>,<br/>
    <span style="color: #ff0000;">[</span><span style="color: #ff0000;">Measures</span><span style="color: #ff0000;">]</span>.<span style="color: #ff0000;">[</span><span style="color: #ff0000;">Reseller Sales Amount</span><span style="color: #ff0000;">]</span>        <br/>
)</code></pre><p><img alt="复制代码" src="http://common.cnblogs.com/images/copycode.gif"/></p><p>以上就是我对动态表达式解析的原理分析。</p>
</div>]
</body>
</html>
