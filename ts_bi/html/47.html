
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
[<div class="message-content editor-style">
<h2 id="articleHeader1">开篇介绍</h2><p>此文章专门记录 XSLT 样式表转换过程中的语法问题</p><h2 id="articleHeader2">错误一 值与属性的倒置</h2><p>修改了几次样式表，但还是一如既往的报错，报错信息如下：</p><p><span style="color: rgb(255, 0, 0);">[XML Task] Error: An error occurred with the following error message: "Attribute and namespace nodes cannot be added to the parent element after a text, comment, pi, or sub-element node has already been added.".</span></p><p>很明显 XML Task 已经告知了错误的原因，即属性或者命名空间的定义不能跟随已经存在的文之后。</p><p>正确的写法：</p><pre><code><span style="font-family: Microsoft YaHei;"><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:stylesheet </span><span style="color: rgb(255, 0, 0);">version</span><span style="color: rgb(0, 0, 255);">="1.0"</span><span style="color: rgb(255, 0, 0);"> xmlns:xsl</span><span style="color: rgb(0, 0, 255);">="http://www.w3.org/1999/XSL/Transform"</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:output </span><span style="color: rgb(255, 0, 0);">method</span><span style="color: rgb(0, 0, 255);">="xml"</span><span style="color: rgb(255, 0, 0);"> indent</span><span style="color: rgb(0, 0, 255);">="yes"</span><span style="color: rgb(0, 0, 255);">/&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:template </span><span style="color: rgb(255, 0, 0);">match</span><span style="color: rgb(0, 0, 255);">="/"</span><span style="color: rgb(0, 0, 255);">&gt;</span> <br/>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">newsalesorder</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:for-each </span><span style="color: rgb(255, 0, 0);">select</span><span style="color: rgb(0, 0, 255);">="SalesOrder/SalesOrderDetail"</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
        <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
            <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderID</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
                <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:attribute </span><span style="color: rgb(255, 0, 0);">name</span><span style="color: rgb(0, 0, 255);">="detailID"</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
                    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:value-of </span><span style="color: rgb(255, 0, 0);">select</span><span style="color: rgb(0, 0, 255);">="SalesOrderDetailID"</span><span style="color: rgb(0, 0, 255);">/&gt;</span><br/>
                <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">xsl:attribute</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
                <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:value-of </span><span style="color: rgb(255, 0, 0);">select</span><span style="color: rgb(0, 0, 255);">="SalesOrderID"</span><span style="color: rgb(0, 0, 255);">/&gt;</span><br/>
            <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderID</span><span style="color: rgb(0, 0, 255);">&gt;</span> <br/>
        <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
    <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">xsl:for-each</span><span style="color: rgb(0, 0, 255);">&gt;</span> <br/>
    <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">newsalesorder</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">xsl:template</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">xsl:stylesheet</span><span style="color: rgb(0, 0, 255);">&gt;</span> </span></code></pre><p>错误的写法 - SalesOrderID 在 XML Task 转换时，源 SalesOrderID 的值一经写出，后面再跟 Attribute 是不正确的，应该是 Attribute 在前。</p><pre><code><span style="font-family: Microsoft YaHei;"><span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:stylesheet </span><span style="color: rgb(255, 0, 0);">version</span><span style="color: rgb(0, 0, 255);">="1.0"</span><span style="color: rgb(255, 0, 0);"> xmlns:xsl</span><span style="color: rgb(0, 0, 255);">="http://www.w3.org/1999/XSL/Transform"</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:output </span><span style="color: rgb(255, 0, 0);">method</span><span style="color: rgb(0, 0, 255);">="xml"</span><span style="color: rgb(255, 0, 0);"> indent</span><span style="color: rgb(0, 0, 255);">="yes"</span><span style="color: rgb(0, 0, 255);">/&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:template </span><span style="color: rgb(255, 0, 0);">match</span><span style="color: rgb(0, 0, 255);">="/"</span><span style="color: rgb(0, 0, 255);">&gt;</span> <br/>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">newsalesorder</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:for-each </span><span style="color: rgb(255, 0, 0);">select</span><span style="color: rgb(0, 0, 255);">="SalesOrder/SalesOrderDetail"</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
        <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
            <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderID</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
                <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:value-of </span><span style="color: rgb(255, 0, 0);">select</span><span style="color: rgb(0, 0, 255);">="SalesOrderID"</span><span style="color: rgb(0, 0, 255);">/&gt;</span><br/>
                <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:attribute </span><span style="color: rgb(255, 0, 0);">name</span><span style="color: rgb(0, 0, 255);">="detailID"</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
                    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">xsl:value-of </span><span style="color: rgb(255, 0, 0);">select</span><span style="color: rgb(0, 0, 255);">="SalesOrderDetailID"</span><span style="color: rgb(0, 0, 255);">/&gt;</span><br/>
                <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">xsl:attribute</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
            <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderID</span><span style="color: rgb(0, 0, 255);">&gt;</span> <br/>
        <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
    <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">xsl:for-each</span><span style="color: rgb(0, 0, 255);">&gt;</span> <br/>
    <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">newsalesorder</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">xsl:template</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">xsl:stylesheet</span><span style="color: rgb(0, 0, 255);">&gt;</span> </span></code></pre><p>正确的输出片段中 detailID 这个 Attribute 属性应该要定义在 SalesOrderID 71774 之前。</p><pre><code><span style="font-family: Microsoft YaHei;"><span style="color: rgb(0, 0, 255);">&lt;?</span><span style="color: rgb(255, 0, 255);">xml version="1.0" encoding="utf-8"</span><span style="color: rgb(0, 0, 255);">?&gt;</span><br/>
<span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">newsalesorder</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
  <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderID </span><span style="color: rgb(255, 0, 0);">detailID</span><span style="color: rgb(0, 0, 255);">="110562"</span><span style="color: rgb(0, 0, 255);">&gt;</span>71774<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderID</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
  <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
  <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderID </span><span style="color: rgb(255, 0, 0);">detailID</span><span style="color: rgb(0, 0, 255);">="110563"</span><span style="color: rgb(0, 0, 255);">&gt;</span>71774<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderID</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
  <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
  <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
    <span style="color: rgb(0, 0, 255);">&lt;</span><span style="color: rgb(128, 0, 0);">salesorderID </span><span style="color: rgb(255, 0, 0);">detailID</span><span style="color: rgb(0, 0, 255);">="110567"</span><span style="color: rgb(0, 0, 255);">&gt;</span>71776<span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderID</span><span style="color: rgb(0, 0, 255);">&gt;</span><br/>
  <span style="color: rgb(0, 0, 255);">&lt;/</span><span style="color: rgb(128, 0, 0);">salesorderdetail</span><span style="color: rgb(0, 0, 255);">&gt;</span></span></code></pre><h2 id="articleHeader3">相关资源</h2><p><a href="http://www.w3school.com.cn/xsl/index.asp%20" target="_blank"><u><font color="#0066cc">XSLT 教程</font></u></a></p>
</div>]
</body>
</html>
