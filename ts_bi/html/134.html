
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
[<div class="message-content editor-style">
<h2 id="articleHeader1">开篇介绍</h2><p>在创建表或者创建存储过程的时候经常会写到： </p><pre><code><span style="color: rgb(0, 0, 255);">IF</span> <span style="color: rgb(255, 0, 255);">OBJECT_ID</span>(<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">Table_Test</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">U</span><span style="color: rgb(255, 0, 0);">'</span>) <span style="color: rgb(0, 0, 255);">IS</span> <span style="color: rgb(128, 128, 128);">NOT</span> <span style="color: rgb(0, 0, 255);">NULL</span><br/>
<span style="color: rgb(0, 0, 255);">DROP</span> <span style="color: rgb(0, 0, 255);">TABLE</span> Table_Test</code></pre><p>这种方式代替了以往所使用的</p><pre><code><span style="color: rgb(0, 0, 255);">IF</span> <span style="color: rgb(128, 128, 128);">EXISTS</span> (<span style="color: rgb(0, 0, 255);">SELECT</span> <span style="color: rgb(128, 128, 128);">*</span> <span style="color: rgb(0, 0, 255);">FROM</span> SYSOBJECTS <span style="color: rgb(0, 0, 255);">WHERE</span> NAME <span style="color: rgb(128, 128, 128);">=</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">Table_Test</span><span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">)<br/>
</span><span style="color: rgb(0, 0, 255);">DROP</span> <span style="color: rgb(0, 0, 255);">TABLE</span> Table_Test</code></pre><h2 id="articleHeader2">OBJECT_ID</h2><p>第一段代码中的 U 可以省略不写，这样系统就会检索所有的对象名称以找到对应的ID，但是写出来就可以更加明确是哪一种类型，筛选的范围要小很多。<br/>以下列出全部 Object type (加粗的是比较常用的)：  </p><p>AF = Aggregate function (CLR)</p><p>C = CHECK constraint</p><p>D = DEFAULT (constraint or stand-alone)</p><p>F = FOREIGN KEY constraint</p><p>FN = SQL scalar function</p><p><strong>FS = Assembly (CLR) scalar-function</strong></p><p><strong>FT = Assembly (CLR) table-valued function</strong></p><p>IF = SQL inline table-valued function</p><p>IT = Internal table</p><p><strong>P = SQL Stored Procedure</strong></p><p>PC = Assembly (CLR) stored-procedure</p><p>PG = Plan guide</p><p>PK = PRIMARY KEY constraint</p><p>R = Rule (old-style, stand-alone)</p><p>RF = Replication-filter-procedure</p><p>S = System base table</p><p>SN = Synonym</p><p>SQ = Service queue</p><p>TA = Assembly (CLR) DML trigger</p><p>TF = SQL table-valued-function</p><p>TR = SQL DML trigger</p><p>TT = Table type</p><p><strong>U = Table (user-defined)</strong></p><p>UQ = UNIQUE constraint</p><p><strong>V = View</strong></p><p>X = Extended stored procedure</p><p>可以通过这个查询语句获取当前数据库中各个数据库表，视图，存储过程等数量。</p><pre><code><span style="color: rgb(0, 0, 255);">SELECT</span> <span style="color: rgb(255, 0, 255);">CASE</span><span style="color: rgb(0, 0, 0);"> TYPE<br>
               </br></span><span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">U</span><span style="color: rgb(255, 0, 0);">'</span>  <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">User Defined Tables</span><span style="color: rgb(255, 0, 0);">'</span><br/>
               <span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">V</span><span style="color: rgb(255, 0, 0);">'</span>  <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">View</span><span style="color: rgb(255, 0, 0);">'</span> <br/>
              <span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">S</span><span style="color: rgb(255, 0, 0);">'</span>  <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">System Tables</span><span style="color: rgb(255, 0, 0);">'</span><br/>
               <span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">IT</span><span style="color: rgb(255, 0, 0);">'</span> <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">Internal Tables</span><span style="color: rgb(255, 0, 0);">'</span><br/>
               <span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">P</span><span style="color: rgb(255, 0, 0);">'</span>  <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">Stored Procedures</span><span style="color: rgb(255, 0, 0);">'</span><br/>
               <span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">PC</span><span style="color: rgb(255, 0, 0);">'</span> <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">CLR Stored Procedures</span><span style="color: rgb(255, 0, 0);">'</span><br/>
               <span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">X</span><span style="color: rgb(255, 0, 0);">'</span>  <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">Extended Stored Procedures</span><span style="color: rgb(255, 0, 0);">'</span><br/>
               <span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">FN</span><span style="color: rgb(255, 0, 0);">'</span> <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">Scalar-valued Functions</span><span style="color: rgb(255, 0, 0);">'</span><br/>
               <span style="color: rgb(0, 0, 255);">WHEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">IF</span><span style="color: rgb(255, 0, 0);">'</span> <span style="color: rgb(0, 0, 255);">THEN</span> <span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">Table-valued Functions</span><span style="color: rgb(255, 0, 0);">'</span><br/>
        <span style="color: rgb(0, 0, 255);">END</span> <span style="color: rgb(0, 0, 255);">AS</span><span style="color: rgb(0, 0, 0);"> Objects,<br/>
        </span><span style="color: rgb(255, 0, 255);">COUNT</span>(<span style="color: rgb(128, 128, 128);">*</span>) <span style="color: rgb(0, 0, 255);">AS</span><span style="color: rgb(0, 0, 0);"> Counts   <br/>
</span><span style="color: rgb(0, 0, 255);">FROM</span><span style="color: rgb(0, 0, 0);"> SYS.OBJECTS<br/>
</span><span style="color: rgb(0, 0, 255);">WHERE</span> TYPE <span style="color: rgb(128, 128, 128);">IN</span> (<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">U</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">V</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">S</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">IT</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">P</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">PC</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">X</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">FN</span><span style="color: rgb(255, 0, 0);">'</span>,<span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(255, 0, 0);">IF</span><span style="color: rgb(255, 0, 0);">'</span><span style="color: rgb(0, 0, 0);">)<br/>
</span><span style="color: rgb(0, 0, 255);">GROUP</span> <span style="color: rgb(0, 0, 255);">BY</span> TYPE</code></pre><p><img alt="" src="http://images.cnitblog.com/i/477275/201404/212354569518905.png"/><br/></p>
</div>]
</body>
</html>
