
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
[<div class="message-content editor-style">
<h2 id="articleHeader1">开篇介绍</h2><p>这篇文章是我在2012年5月份写在 Google Blog 上的一篇英文博客 <a href="http://simonlv.blogspot.com/2012/05/ssis-step-by-step.html">http://simonlv.blogspot.com/2012/05/ssis-step-by-step.html</a> ，当然这篇博客在国内其实是无法访问的。也忘记当时为什么要用英文写博客的原因了，大概齐当时可能正好在美国出差心里有那么点小九九，可能觉得把技术博客写牛一点以后到美国可能找个微软 BI 开发的工作好找一点。后来出差结束回国了，上网访问不太方便可能就没有继续再更新了。因为这些 Step by Step 博客陆陆续续有很多老外加我 Skype 或者发邮件给我，尤其三哥众多。前几天还有一个三哥问我为什么不更新博客了，我说我没有时间写，他说为什么不雇一个人继续写 ? (#￥#%￥@ 我去！ 我是穷疯了吗？)，我说我没有钱雇人.....三哥是不是觉得很不好笑。我看他头像年龄不小，觉得应该有将近40了吧，以为是哪家大公司的高管还窃窃自喜是不是有啥好事来了？ 结果冒昧的问了一句 How old are you?  靠！22 ！三哥..... 果然是少年老成，比我们要成熟一些！</p><p><img alt="2015-10-08_001541.jpg" height="872" src="http://www.flybi.net/uploads/article/20151007/ba111d80df58eb38dc9597c3a7b49a80.jpg" width="1199"/></p><p>英文水平就这么高，稍稍把以前的语句整理一下就将就看看吧。</p><h2 id="articleHeader2">Requirement &amp; Preface</h2><p>In this post, I'm going to introduce something about file processing. This demo could be a small project or a solution and I will show you many SSIS skills and some very tricky things. </p><p>The requirements are:</p><p>1. Here's specified folder, for example -</p><p><img alt="1.png" height="227" src="http://www.flybi.net/uploads/article/20151007/b80a4dbe9c8374543f82e471049ef22a.png" width="640"/></p><p>We need to read this directory and record the information of all files into a table. </p><p>The information - File Name, Created Date, Modified Date, File Type, File Path, size etc.</p><p>2. If the file is updated, then sync the changes to database.</p><p>For example, if the file A has been modified, the modified date will be a new date. When we run package, the new changes will be updated in database with new file size, modified date etc. </p><p>3. If the file is deleted, database will sync this information and won't show the file's information.</p><p>3. If a new file is added, database will sync this information and show the new file's information.</p><p>4. It also will record the historical information of files.</p><h2 id="articleHeader3">What's new in this post ?</h2><p>1. How to get a batch of files in a script ?</p><p>2. How to get file's information - File Name, Created Date, Modified Date, File Type ?</p><p>3. How to use Look Up component to redirect Matched and NON-Matched records?</p><p>4. How to use Derived Column component to create a new column or replace some column value ?</p><p>5. How to design a simple documents-sync framework ? (Rome was not built in a day, the database design and SSIS package design will be updated until it meets all requirements, so the steps of this post will confuse you - how did you know this component should be here but not there ? This example is updated on and off for 5 times, I have to test it until it meet my requirements.)</p><h2 id="articleHeader4">Preparations</h2><p>1. Make sure you have created these tables in demo database - SSISDemoDB.    </p><pre><code class="lang-sql"><span style='color: blue; font-family: "Courier New";'>USE</span><span style='font-family: "Courier New";'> SSISDemoDB</span><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>GO<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>IF</span><span style='font-family: "Courier New";'> <span style="color: magenta;">OBJECT_ID</span><span style="color: grey;">(</span><span style="color: red;">'DocumentTypeMapping'</span><span style="color: grey;">)</span> <span style="color: grey;">IS</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>DROP</span><span style='font-family: "Courier New";'> <span style="color: blue;">TABLE</span> DocumentTypeMapping <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>CREATE</span><span style='font-family: "Courier New";'> <span style="color: blue;">TABLE</span> DocumentTypeMapping<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      ID <span style="color: blue;">INT</span> <span style="color: blue;">IDENTITY</span><span style="color: grey;">(</span>1<span style="color: grey;">,</span>1<span style="color: grey;">)</span> <span style="color: blue;">PRIMARY</span> <span style="color: blue;">KEY</span><span style="color: grey;">,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FileExtension <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>50<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FileTypeDescription <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>100<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>)<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>INSERT</span><span style='font-family: "Courier New";'> <span style="color: blue;">INTO</span> DocumentTypeMapping <span style="color: blue;">VALUES<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'dtsx'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Integration Services Package'</span><span style='color: grey; font-family: "Courier New";'>),<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'database'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Analysis Services Database'</span><span style='color: grey; font-family: "Courier New";'>),<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'dtproj'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Integration Services project file'</span><span style='color: grey; font-family: "Courier New";'>),<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'user'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Visual Studio Project User Options file'</span><span style='color: grey; font-family: "Courier New";'>),<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'dtsx'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Integration Services Package'</span><span style='color: grey; font-family: "Courier New";'>),<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'txt'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Text Document'</span><span style='color: grey; font-family: "Courier New";'>),<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'xlsx'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Microsoft Excel Worksheet'</span><span style='color: grey; font-family: "Courier New";'>),<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'xlsx'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Microsoft Excel Worksheet'</span><span style='color: grey; font-family: "Courier New";'>)</span><span style='font-family: "Courier New";'> <span style="color: grey;">,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'vsd'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Microsoft Visio Drawing'</span><span style='color: grey; font-family: "Courier New";'>),<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(</span><span style='color: red; font-family: "Courier New";'>'doc'</span><span style='color: grey; font-family: "Courier New";'>,</span><span style='color: red; font-family: "Courier New";'>'Microsoft Word Document 2003-2007  '</span><span style='color: grey; font-family: "Courier New";'>)<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>IF</span><span style='font-family: "Courier New";'> <span style="color: magenta;">OBJECT_ID</span><span style="color: grey;">(</span><span style="color: red;">'DocumentsStaging'</span><span style="color: grey;">)</span> <span style="color: grey;">IS</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>DROP</span><span style='font-family: "Courier New";'> <span style="color: blue;">TABLE</span> DocumentsStaging<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>CREATE</span><span style='font-family: "Courier New";'> <span style="color: blue;">TABLE</span> DocumentsStaging<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      ID <span style="color: blue;">INT</span> <span style="color: blue;">IDENTITY</span><span style="color: grey;">(</span>1<span style="color: grey;">,</span>1<span style="color: grey;">)</span> <span style="color: blue;">PRIMARY</span> <span style="color: blue;">KEY</span><span style="color: grey;">,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      NAME <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>500<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FullPath <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>2000<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      CreatedDate <span style="color: blue;">DATETIME</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FirstModifiedDate <span style="color: blue;">DATETIME</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      NewModifiedDate     <span style="color: blue;">DATETIME</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FileType <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>200<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      Size <span style="color: blue;">BIGINT</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      BatchInsertTime <span style="color: blue;">DATETIME</span> <span style="color: blue;">DEFAULT</span> <span style="color: magenta;">GETDATE</span><span style="color: grey;">()</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>)<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>IF</span><span style='font-family: "Courier New";'> <span style="color: magenta;">OBJECT_ID</span><span style="color: grey;">(</span><span style="color: red;">'Documents'</span><span style="color: grey;">)</span> <span style="color: grey;">IS</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>DROP</span><span style='font-family: "Courier New";'> <span style="color: blue;">TABLE</span> Documents<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>CREATE</span><span style='font-family: "Courier New";'> <span style="color: blue;">TABLE</span> Documents<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      ID <span style="color: blue;">INT</span> <span style="color: blue;">IDENTITY</span><span style="color: grey;">(</span>1<span style="color: grey;">,</span>1<span style="color: grey;">)</span> <span style="color: blue;">PRIMARY</span> <span style="color: blue;">KEY</span><span style="color: grey;">,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      NAME <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>500<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FullPath <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>2000<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      CreatedDate <span style="color: blue;">DATETIME</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      ModifiedDate <span style="color: blue;">DATETIME</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FileType <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>200<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      Size <span style="color: blue;">INT</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      Operation <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>50<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>)<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>IF</span><span style='font-family: "Courier New";'> <span style="color: magenta;">OBJECT_ID</span><span style="color: grey;">(</span><span style="color: red;">'DocumentsErrorExtension'</span><span style="color: grey;">)</span> <span style="color: grey;">IS</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>DROP</span><span style='font-family: "Courier New";'> <span style="color: blue;">TABLE</span> DocumentsErrorExtension<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>CREATE</span><span style='font-family: "Courier New";'> <span style="color: blue;">TABLE</span> DocumentsErrorExtension<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>(<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      ID <span style="color: blue;">INT</span> <span style="color: blue;">IDENTITY</span><span style="color: grey;">(</span>1<span style="color: grey;">,</span>1<span style="color: grey;">)</span> <span style="color: blue;">PRIMARY</span> <span style="color: blue;">KEY</span><span style="color: grey;">,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      NAME <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>500<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FullPath <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>2000<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,</span> <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      FileType <span style="color: blue;">NVARCHAR</span><span style="color: grey;">(</span>200<span style="color: grey;">)</span> <span style="color: grey;">NOT</span> <span style="color: grey;">NULL,</span>  <o:p></o:p></span></div><div class="MsoNormal"><span style='color: grey; line-height: 115%; font-family: "Courier New";'>)</span><br/></div></code></pre><h3 id="articleHeader5">Description  </h3><p>Table <b>DocumentTypeMapping </b>shows the description of specified file, usually we get a file with its extension like - .doc , .txt, .ppt. We won't show user such information because the user may not understand what does '.ppt' or 'prot' mean, so please configure this mapping before you composed your file processing package.</p><p>Table <b>DocumentsStaging </b>- It mostly like a historical table which records all documents information in historically loading files from specified directory. </p><p>For example, the first time we load folder 'Test', there're A,B,C file in this folder, we record these information when we run the package at the first time. But at the second time when we run this package, we only find file B inside and a new file D.</p><p>Then we will record like this -</p><p>ID, File Name, BatchInsertTime</p><p>1   A          2011</p><p>2   B          2011</p><p>3   C          2011</p><p>4   B          2012</p><p>5   D          2012</p><p>Table <b>Documents </b>will only show the current existing files in specified folder.</p><p>So the first time when we load files, it will show - </p><p>ID, File Name, BatchInsertTime</p><p>1   A          2011</p><p>2   B          2011</p><p>3   C          2011</p><p>The second time it will show - </p><p>ID, File Name, BatchInsertTime </p><p>1   B          2012</p><p>2   D          2012</p><p>Because system will think the file A and C have been deleted by user or their name has been changed. </p><p>So if user want a report to show files information, table DocumentsStaging can show the history and table Documents can show current information of files.</p><p>Table <b>DocumentsErrorExtension </b>will record all mismatched file type. For example, there's no description for file extension - '.mdb'. If package process a new file with file extension .mdb, the information the this file won't be recorded in table Documents, it will be recored in DocumentsErrorExtension to let system admin know this file doesn't has a file type description, we need to insert a description for this file first.</p><h2 id="articleHeader6">SSIS Framework</h2><p>Control Flow -</p><p><img alt="2.png" height="470" src="http://www.flybi.net/uploads/article/20151007/0e31d5d357ef61ae2fd1c0ccdc9b4685.png" width="640"/></p><p>Data Flow - </p><p><img alt="3.png" height="447" src="http://www.flybi.net/uploads/article/20151007/4068868d68816fee3bdead2c4437bba4.png" width="640"/></p><p>Package Variables -</p><p><img alt="2015-10-08_004407.jpg" height="285" src="http://www.flybi.net/uploads/article/20151007/eb64e2694071175cdbcd4eca96373507.jpg" width="341"/></p><h3 id="articleHeader7">Steps</h3><p>1. Create a package 'CH03_SyncDocuments' and defined package variables as above figure.</p><p>Package variable - Files. It will be used to store all file names from specified package variable - Directory.</p><p>Please assign your custom file folder path to 'Directory'</p><p>2. Drag a script component to Control Flow Pane, name it as 'SRC_GetFileNames', click to open it.</p><p>    ReadOnlyVariables - Directory (We have assigned a value to this variable in step 1)</p><p>    ReadWriteVariables - Files (All file names will be saved in this variable)</p><p><img alt="4.png" height="522" src="http://www.flybi.net/uploads/article/20151007/0d7ba01d2b13ea21374ea5565f192690.png" width="640"/></p><p>Click Edit Script and import System.IO in default class, add such codes.</p><pre><code class="lang-cs"><font color="#0000ff" face="新宋体">public</font><span style="font-family: 新宋体;"> <span style="color: blue;">void</span> Main()<o:p></o:p></span><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">        {<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            <span style="color: green;">//Get the directory from user defined variable<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            <span style="color: blue;">string</span> directory = Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::Directory"</span>].Value.ToString();<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            <span style="color: green;">//Get all file names in specified directory<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            <span style="color: blue;">string</span>[] fileNames = <span style="color: rgb(43, 145, 175);">Directory</span>.GetFiles(directory);<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            <span style="color: green;">//Save to user defined variable<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::Files"</span>].Value = fileNames;<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.TaskResult = (<span style="color: blue;">int</span>)<span style="color: rgb(43, 145, 175);">ScriptResults</span>.Success;<o:p></o:p></span></div><div class="MsoNormal"><span style="line-height: 115%; font-family: 新宋体;">        }</span><br/></div></code></pre><p>Save these changes and run package to make sure if can you see a green status of component. If script component becomes green, that means we can load all file names correctly from specified folder.</p><p>We often do this test when we finished a configuration to each component. </p><p>3. Drag a loop foreach container as figure shows (Files Loop):</p><p><img alt="5.png" height="303" src="http://www.flybi.net/uploads/article/20151007/42817e32d22076a60499718862611ebd.png" width="390"/></p><p><img alt="6.png" height="543" src="http://www.flybi.net/uploads/article/20151007/b3ad809dd662d9728b3e6b76670b3611.png" width="640"/><img alt="7.png" height="543" src="http://www.flybi.net/uploads/article/20151007/d57e8c2e146fa56efaedd2beeaf634b9.png" width="640"/></p><p>User::FilePath's value is from User::Files in a loop. </p><p>4. Drag a script component with name 'SCR_LoadFileInformation' into loop container, edit this component </p><p>    We use User::FilePath to load a file and read all properties of this file.    </p><p>    ReadWriteVariables are variables which will save all loaded properties from a file.</p><p><img alt="8.png" height="386" src="http://www.flybi.net/uploads/article/20151007/7dc82c3e18eb152eba7ab419516b1414.png" width="640"/></p><p>Edit script, import System.IO and try to understand such code inside -</p><pre><code class="lang-cs"><font color="#0000ff" face="新宋体">public</font><span style="font-family: 新宋体;"> <span style="color: blue;">void</span> Main()<o:p></o:p></span><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">        {<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            <span style="color: blue;">string</span> fileName = Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::FilePath"</span>].Value.ToString();<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            <span style="color: rgb(43, 145, 175);">FileInfo</span> file = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">FileInfo</span>(fileName);<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::Name"</span>].Value = file.Name;<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::CreatedDate"</span>].Value = file.CreationTime;<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::ModifiedDate"</span>].Value = file.LastWriteTime;<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::FileType"</span>].Value = file.Extension.Replace(<span style="color: rgb(163, 21, 21);">'.'</span>,<span style="color: rgb(163, 21, 21);">' '</span>).Trim();<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::Size"</span>].Value = (<span style="color: blue;">int</span>)(file.Length/1024);<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.Variables[<span style="color: rgb(163, 21, 21);">"User::FilePath"</span>].Value = file.FullName;<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><br/></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style="font-family: 新宋体;">            Dts.TaskResult = (<span style="color: blue;">int</span>)<span style="color: rgb(43, 145, 175);">ScriptResults</span>.Success;<o:p></o:p></span></div><div class="MsoNormal"><span style="line-height: 115%; font-family: 新宋体;">        }</span><br/></div></code></pre><p>How to pass a package variables and how to assign value to package variables ? You should know the answers.</p><p>Run this package, you should make sure all components are green finally.</p><p>5. In loop container, add Execute SQL Task with name EST_InsertFileInLoop, edit it.</p><p>You should know how to build a OLE DB connection, I have mentioned it in previous posts.</p><p>For SQL Statement, we need to build a SQL to insert all document information to a staging table, the parameter will use ? to instead of the real value, we will configure parameters in 'Parameter Mapping'.</p><p><img alt="9.png" height="479" src="http://www.flybi.net/uploads/article/20151007/57244c4a911016d6c04d60818d0b0b50.png" width="640"/></p><p>We need to know which values we should to insert, then map them like below figure shows:</p><pre><code class="lang-sql">CREATE TABLE DocumentsStaging<br/> (<br/><span class="Apple-tab-span" style="white-space: pre;"> </span>ID INT IDENTITY(1,1) PRIMARY KEY,<br/><span class="Apple-tab-span" style="white-space: pre;"> </span>NAME NVARCHAR(500) NOT NULL,                           -- User::Name <br/><span class="Apple-tab-span" style="white-space: pre;"> </span>FullPath NVARCHAR(2000) NOT NULL,                        -- User::FilePath<br/><span class="Apple-tab-span" style="white-space: pre;"> </span>CreatedDate DATETIME NOT NULL,                              -- User::CreatedDate<br/><span class="Apple-tab-span" style="white-space: pre;"> </span>FirstModifiedDate DATETIME NOT NULL,                    -- User::ModifiedDate<br/><span class="Apple-tab-span" style="white-space: pre;"> </span>NewModifiedDate<span class="Apple-tab-span" style="white-space: pre;"> </span>  DATETIME NOT NULL,                 -- User::ModifiedDate<br/><span class="Apple-tab-span" style="white-space: pre;"> </span>FileType NVARCHAR(200) NOT NULL,                         -- User::FileType<br/><span class="Apple-tab-span" style="white-space: pre;"> </span>Size BIGINT NOT NULL,                                                  -- User::Size  (KB)<br/><span class="Apple-tab-span" style="white-space: pre;"> </span>BatchInsertTime DATETIME DEFAULT GETDATE() NOT NULL  -- System Variable: System::StartTime<br/> )<br/></code></pre><p><img alt="10.png" height="479" src="http://www.flybi.net/uploads/article/20151007/a490d6e4be3257a8bf5a056ce8d937db.png" width="640"/></p><p><strong>FirstModifiedDate DATETIME NOT NULL,                    -- User::ModifiedDate<br/>NewModifiedDate   DATETIME NOT NULL,                 -- User::ModifiedDate</strong></p><ul><li>In Windows OS, we use C# can easily get a file's properties like created date and modified date.   </li><li>For example, I created a file on 05/01/2011.  Then I updated this file with new contents on 06/01/2011.</li><li>So the created date property of this file is  - 05/01/2011, the modified date property is 06/01/2011.<br/></li><li>But for this demo, we need to know which files are new added, which files are new updated, the basis is we judge if the created date is same as modified date. If created date = modified date, this file is new added, if created date &lt;&gt; modified date, we think this file has been updated.<br/></li><li>The problem for this demo is, if we load this file on 07/01/2011 at the first time, what conclusion we should make ? Is is a updated file or a new file. Actually it should be a new file to us, it may be edited several times before our package load it.<br/></li><li>So I design two columns in tables, both columns store the value of Last Access Time of the file. The FirstModifiedDate doesn't mean the real first update time (06/01/2011) but means the last modified time when loading this file to staging table.<b><i><br/></i></b></li></ul><p><b><i>BatchInsertTime DATETIME DEFAULT GETDATE() NOT NULL  -- System Variable: System::StartTime</i></b></p><ul><li>    We need to record which files are loaded per every time we run this package. </li></ul><p><img alt="11.png" height="303" src="http://www.flybi.net/uploads/article/20151007/a9f045d47bc2fb268b2bea8629cd2625.png" width="390"/></p><p>You should understand the above steps doing:</p><ul><li>Get all file names and save to an object which is used in loop container.</li><li>Each loop, we can use a file name to load a file and get properties of this file. All properties of a file are save in different package variables.</li><li>Map these package variables and compose SQL with these variable to insert a file into staging table.</li><li>When the loop ends, the information of all files are recorded. </li></ul><p> 6. Build Execute SQL Task to delete error extension information and add a data flow task to process the main sync logic.</p><p> Execute SQL Task - EST_DeleteErrorType</p><p> Data Flow Task - UpdateDocuments</p><p><img alt="12.png" height="400" src="http://www.flybi.net/uploads/article/20151007/2be5f8f8d4a94965cd36d53118814a51.png" width="237"/></p><p>Edit EST_DeleteErrorTypes with existing OLE DB connection.SQL Statement - </p><pre><code class="lang-sql"><p><span style="color: blue;">DELETE</span> <span style="color: blue;">FROM</span> dbo<span style="color: grey;">.</span>DocumentsErrorExtension</p><p><span style="color: blue;">WHERE</span> FileType <span style="color: grey;">IN(</span></p><p>      <span style="color: blue;">SELECT</span> <span style="color: blue;">DISTINCT</span> FileType</p><p>      <span style="color: blue;">FROM</span> dbo<span style="color: grey;">.</span>DocumentsStaging</p><p><span style="color: grey;">)</span><br/></p></code></pre><p><img alt="13.png" height="543" src="http://www.flybi.net/uploads/article/20151007/88af5b1e138e1d23213b7f78bb5045c6.png" width="640"/></p><p>The component is used to delete all error information from DocumentErrorExtension.  If the file type of a file doesn't map to mapping table, the information will be recorded in DocumentErrorExtension.</p><p> Go into data flow task - click 'UpdateDocuments', we 're going to design data flow task to sync documents.</p><p> 7. Please see the data flow framework again.</p><p><img alt="14.png" height="447" src="http://www.flybi.net/uploads/article/20151007/9c48240cb2c53cae8958c53f469bda73.png" width="640"/></p><p>The main logic is -</p><ul><li>Get last batch documents from staging table to look up documents table.</li><li>NO Match - The current file doesn't exist in documents table, then insert new file information to documents (Also need to compare the file type, if the file type doesn't exist in file type mapping table, it will redirect to error extension table).</li><li>Match - The current file exists in documents table, need to update document information in document table.</li></ul><p> 8. Add OLE DB Source in data flow, new name is 'OLE_SRC_GetStaging', edit it.</p><p>     Getting the last batch of files from staging table as a source.<span style="color: blue;"><br/></span></p><pre><code class="lang-sql"><p><span style="color: blue;">  SELECT</span> <span style="color: grey;">*</span></p><p><span style="color: blue;">  FROM</span> dbo<span style="color: grey;">.</span>DocumentsStaging</p><p><span style="color: blue;">  WHERE</span> BatchInsertTime <span style="color: grey;">=</span><span style="color: blue;"> </span><span style="color: grey;">(</span><span style="color: blue;">SELECT</span> <span style="color: magenta;">MAX</span><span style="color: grey;">(</span>BatchInsertTime<span style="color: grey;">)</span> <span style="color: blue;">FROM</span> dbo<span style="color: grey;">.</span>DocumentsStaging<span style="color: grey;">)</span><br/></p></code></pre><p><img alt="15.png" height="551" src="http://www.flybi.net/uploads/article/20151007/01e2b6585a9fa2536ffd63bde9886d5e.png" width="640"/></p><p> Pass all columns to next component.</p><p><img alt="16.png" height="551" src="http://www.flybi.net/uploads/article/20151007/d4b413db94b7b51c7af01e1df964a1cf.png" width="640"/></p><p>9. Add a look up component - 'LKP_LookUpDocuments', edit this component.</p><p>     Choose 'Redirect rows to no match output'</p><p><img alt="17.png" height="553" src="http://www.flybi.net/uploads/article/20151007/2906c438710dc1e7c602ae1f6da1ff21.png" width="640"/></p><p>Use 'Document' table as a look up table. </p><p><img alt="18.png" height="553" src="http://www.flybi.net/uploads/article/20151007/b04e973cc205492c9987634474b7f4a4.png" width="640"/></p><p>Available Input columns are from 'OLE_SRC_GetStaging', please see Step 8.</p><p> Available Lookup Columns are from table Documents.</p><p> Simply to say, there're two tables - DocumentsStaging and Documents. Just like the join in SQL, we use NAME and CreatedDate to see if files in staging exist in Documents.</p><p> There're two results here, Matched and NON-Matched, so two outputs are also generated in this component - Matched Output and NON-Matched Output, these outputs can be a source for next data flow component.</p><p> Drag 'Name' in input column to the 'Name' in lookup columns, same operation to CreatedDate.</p><p><img alt="19.png" height="553" src="http://www.flybi.net/uploads/article/20151007/a7f96b9cf9b64cf9e70521a8e11d587d.png" width="640"/></p><p>10. For No Match Output, we're going to insert a new record. But we need to check if the file type exist in mapping table first.</p><p><img alt="20.png" height="237" src="http://www.flybi.net/uploads/article/20151007/505bcf14ed1fe35e86cda884ddc68a3c.png" width="567"/></p><p>Drag a lookup component 'LKP_Look Up File Extension' and tie to 'LKP_LookUpDocuments', choose 'Lookup No Match Output' when message box shows up.</p><p>Drag a OLE DB Components  CMD_UpdateDocuments' and tie to 'LKP_LookUpDocuments', choose 'Lookup Match Output' when message box shows up.</p><p>Need to understand the source of Matched and Non-Matched components.</p><p>For Non Matched component 'LKP_Look Up File Extension', its source columns are from the original source 'OLE_SRC_GetStaging'.</p><p>For Matched component 'CMD_UpdateDocuments', its source columns are from the join columns of 'OLE_SRC_GetStaging' and       'LKP_LookUpDocuments' base on 'Name' and 'CreatedDate'.</p><p> 11. Edit LKP_Look Up File Extension</p><p><img alt="21.png" height="553" src="http://www.flybi.net/uploads/article/20151007/91a90174be4224c0b98a3e5afe67824e.png" width="640"/></p><p>Choose look up table - DocumentTypeMapping</p><p><img alt="22.png" height="553" src="http://www.flybi.net/uploads/article/20151007/4b8dedc411892a4413992a8d3b8bcc98.png" width="640"/></p><p>File Type in input columns maps to File Extension in look up columns. </p><p><img alt="23.png" height="553" src="http://www.flybi.net/uploads/article/20151007/f19ed2c247883463febc77103bf87a45.png" width="640"/></p><p>12. If mapped, that means the file type from staging table is correct type, otherwise, it should be incorrect file type which haven't been recorded in file mapping table.</p><p><img alt="24.png" height="205" src="http://www.flybi.net/uploads/article/20151007/48f776288cf2929882e2c3e5d620e9c2.png" width="400"/></p><p> 13. If mapped, we get those records from staging table with the file type description and insert into table Documents.</p><p>       Drag a Derived Column component ''DC_InsertOperation' and tie to 'LKP_Look Up File Extension' by using 'Lookup Match Output', edit it.<img alt="25.png" height="530" src="http://www.flybi.net/uploads/article/20151007/dfe9dd1767dfed864c9b1400a5299ffb.png" width="640"/></p><p>A new column 'Operation' will be built with a value 'NEW', this column will be added into up stream input columns and will be passed together to next component as a source.</p><p> 14. Add an OLE DB Destination component 'DEST_InsertNewDocuments' to connect to ''DC_InsertOperation', edit it.</p><p><img alt="26.png" height="553" src="http://www.flybi.net/uploads/article/20151007/551a9091a48fb5be5be063eccba9c219.png" width="640"/></p><p>Do mapping.</p><p><img alt="27.png" height="553" src="http://www.flybi.net/uploads/article/20151007/4e8087df6e174e5b7183722f3d693f0f.png" width="640"/></p><p>15. Drag another component 'DEST_NoMatchedFileExtension', edit it.</p><p><img alt="28.png" height="553" src="http://www.flybi.net/uploads/article/20151007/482af72e988a52907a29cb7119b1dd58.png" width="640"/></p><p><img alt="29.png" height="553" src="http://www.flybi.net/uploads/article/20151007/39d81f78dee00811c309058bc049e7cd.png" width="640"/></p><p>16. CMD_UpdateDocuments</p><p><img alt="30.png" height="233" src="http://www.flybi.net/uploads/article/20151007/6928fc362d4d299de995d05f0687dd9e.png" width="400"/> </p><p>OLE DB Connection</p><p><img alt="31.png" height="600" src="http://www.flybi.net/uploads/article/20151007/935d1d4b2ef6cae24c252f317382a330.png" width="640"/></p><p>Edit SQL Command</p><pre><code class="lang-sql"><span style='color: blue; font-family: "Courier New";'>UPDATE</span><span style='font-family: "Courier New";'> dbo<span style="color: grey;">.</span>Documents <o:p></o:p></span><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>SET</span><span style='font-family: "Courier New";'> FullPath <span style="color: grey;">=</span> ?<span style="color: grey;">,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>        ModifiedDate <span style="color: grey;">=</span> ?<span style="color: grey;">,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>        Size <span style="color: grey;">=</span> ?<span style="color: grey;">,<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>        Operation <span style="color: grey;">=</span> <span style="color: red;">'UPDATE'<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>WHERE</span><span style='font-family: "Courier New";'> NAME <span style="color: grey;">=</span> ? <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>          <span style="color: grey;">AND</span>     FileType <span style="color: grey;">=</span> ? <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>          <span style="color: grey;">AND</span>     CreatedDate <span style="color: grey;">=</span> ? <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>          <span style="color: grey;">AND</span>     <span style="color: magenta;">UPPER</span><span style="color: grey;">(</span>Operation<span style="color: grey;">)</span> <span style="color: grey;">=</span> <span style="color: red;">'NEW'<o:p></o:p></span></span></div><div class="MsoNormal"><span style='line-height: 115%; font-family: "Courier New";'>          <span style="color: grey;">AND</span>     ModifiedDate <span style="color: grey;">&lt;&gt;</span>  ?</span><br/></div></code></pre><p><img alt="32.png" height="600" src="http://www.flybi.net/uploads/article/20151007/cc1d956fd73e514598d416cbf59c0fe3.png" width="640"/></p><p><img alt="33.png" height="600" src="http://www.flybi.net/uploads/article/20151007/eb8f596067c94d2c2e8bfd9d044881fb.png" width="640"/></p><p> 17. CMD_DeleteNONExistDoc</p><pre><code class="lang-sql"> <span style='color: blue; font-family: "Courier New";'>DELETE</span><span style='font-family: "Courier New";'> <span style="color: blue;">FROM</span> dbo<span style="color: grey;">.</span>Documents</span><br/><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>  WHERE</span><span style='font-family: "Courier New";'> Name <span style="color: grey;">NOT</span> <span style="color: grey;">IN(<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      <span style="color: blue;">SELECT</span> NAME <span style="color: blue;">FROM</span> <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      dbo<span style="color: grey;">.</span>DocumentsStaging<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      <span style="color: blue;">WHERE</span> BatchInsertTime <span style="color: grey;">=</span> <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: blue; font-family: "Courier New";'>      </span><span style='color: grey; font-family: "Courier New";'>(<o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>            <span style="color: blue;">SELECT</span> <span style="color: magenta;">MAX</span><span style="color: grey;">(</span>BatchInsertTime<span style="color: grey;">)<o:p></o:p></span></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>            <span style="color: blue;">FROM</span> dbo<span style="color: grey;">.</span>DocumentsStaging  <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='font-family: "Courier New";'>      <span style="color: grey;">)</span> <o:p></o:p></span></div><div class="MsoNormal" style="margin-bottom: 0pt;"><span style='color: grey; font-family: "Courier New";'>  )<o:p></o:p></span><br/></div></code></pre><p><img alt="34.png" height="600" src="http://www.flybi.net/uploads/article/20151007/f480efa0c5c1fd620cfe8f08f9ee1708.png" width="640"/></p><p>18. Test</p><p><img alt="35.png" height="175" src="http://www.flybi.net/uploads/article/20151007/8ffd2c3c417444b07f1c2a15ef1dd852.png" width="640"/></p><p><img alt="36.png" height="492" src="http://www.flybi.net/uploads/article/20151007/6a134f111765662d7b64c0a496a73159.png" width="640"/></p><p><img alt="37.png" height="353" src="http://www.flybi.net/uploads/article/20151007/cdb91bb408c98fb29efecadac804908d.png" width="640"/></p><p>19. Add a new file </p><p><img alt="38.png" height="207" src="http://www.flybi.net/uploads/article/20151007/ed9de6408c6e9fcf22b17f50377f2743.png" width="400"/></p><p><img alt="39.png" height="354" src="http://www.flybi.net/uploads/article/20151007/e826573f8b47e47a7f4e78f71627e044.png" width="640"/></p><p>20. Update contents.</p><p><img alt="40.png" height="206" src="http://www.flybi.net/uploads/article/20151007/43a8d848c01d4bf893b324f0ffbd6dfb.png" width="400"/></p><p><br/></p><p><img alt="41.png" height="172" src="http://www.flybi.net/uploads/article/20151007/fa02e5fb8acbee13808a98ac7fb35d94.png" width="640"/></p><h2 id="articleHeader8">FINISH!!!</h2>
<ul class="aw-upload-file-list">
</ul>
</div>]
</body>
</html>
