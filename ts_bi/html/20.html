
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
[<div class="message-content editor-style">
<h3 id="articleHeader1" style="margin-left: 0px;">开篇介绍</h3><p>在 ETL 项目中的SSIS 包中的参数是可配置的，为了更好的控制人为传入的参数的正确性，或者为了确保 SSIS 程序的健壮性，那么在包执行之初会对 SSIS 包参数进行验证。包参数通过验证，则说明参数是可靠的，ETL 逻辑可以继续执行。如果不能通过验证，那么就需要格外的进行逻辑处理或者包将主动报错，这样就不会后期数据处理上的问题。并且前期的验证，可以省去后期逻辑处理阶段的重复验证工作。</p><p>一般情况下，Script Task 经常可以用来处理这方面的验证操作，特别是文件类，输入输出文件的路径验证等等 Script Task 是再合适不过的了。包括对时间参数的验证，时间段范围参数的验证，甚至包括数据源链接的验证都可以在 Script Task 中去完成，今天在这里着重介绍一下与文件路径相关的验证。</p><h3 id="articleHeader2" style="margin-left: 0px;">文件路径参数验证</h3><p>通常情况下在一个有文件输入和输出的 ETL 项目中，对于文件路径配置的设计一般包含以下几类变量 - </p><ol><li>文件输入方面的<ol><li>PV_INPUT_DIRECTORY</li><li>PV_INPUT_FOLDER</li><li>PV_INPUT_EMPLOYEE_FILE_NAME</li></ol></li><li>文件输出方面的文件归档方面的<ol><li>PV_OUTPUT_DIRECTORY</li><li>PV_OUTPUT_FOLDER</li><li>PV_OUTPUT_EMPLOYEE_FILE_NAME</li></ol></li><li>文件归档方面的</li><ol><li>PV_ARCHIVE_DIRECTORY</li><li>PV_ARCHIVE_FOLDER</li><li>PV_ARCHIVE_EMPLOYEE_FILE_NAME</li></ol></ol><p style="margin-left: auto;"><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041625313944335.png"/></p><p>要注意到上图中 PV_INPUT_EMPLOYEE_FILE_PATH 是经过验证之后没有问题的 PV_INPUT_DIRECTORY + PV_INPUT_FOLDER + PV_INPUT_EMPLOYEE_FILE_NAME 的路径拼接字符串。它的值可以直接通过 Expression 来配置或者通过 Script Task 中的代码来设置，它的使用是非常非常灵活的。在这个例子中，我们通过 Script Task 验证，验证通过后直接在 Script Task 中赋值。</p><h3 id="articleHeader3" style="margin-left: 0px;">要验证的内容</h3><p>一个 ETL 包可能有一个或者多个文件输入源，那么这些文件数据源应该有指定的总目录，子文件夹，然后应该提供具体的文件名称。</p><ol><li>对于输入源的验证就应该包含这三方面的验证，可以直接对文件验证，也可以分的很细的对每一个对象进行验证。</li><li>对于输出源来说，首先输出的总目录和子文件夹是需要被验证的，再次要取决于实际的需求，输出文件是要求事先存在或是不存在而决定对输出文件的验证。</li><li>对于归档类的验证和输出源应该是差不多一样的。</li></ol><p>为了演示验证的过程，我们就只验证 INPUT 文件的路径是否合法，通过这个过程可以理解对其它的参数验证是如何实现的。</p><p>新建一个 Script Task，除了 PV_INPUT_EMPLOYEE_FILE_PATH 是可读写的外，其它的 INPUT 类型的变量都是只读的，并且把系统变量 PackageName 也加入进来。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041625541285981.png"/></p><p>编辑 Script Task 中的代码，因为涉及到文件类的操作，因此需要引入 IO 命名空间。</p><pre><code><span style='font-family: "Microsoft YaHei"; line-height: 1.5 !important;'><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>#region</span> Namespaces<br/>
<span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>using</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> System;<br/>
</span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>using</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> System.Data;<br/>
</span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>using</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> Microsoft.SqlServer.Dts.Runtime;<br/>
</span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>using</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> System.Windows.Forms;<br/>
</span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>using</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> System.IO;<br/>
</span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>#endregion</span></span></code></pre><p style="margin-left: auto;">Main 方法中的代码如下 - </p><pre><code><span style='font-family: "Microsoft YaHei"; line-height: 1.5 !important;'><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>public</span> <span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>void</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> Main()<br/>
  {<br/>
   </span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>//</span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> TODO: Add your code here<br/>
            </span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>//</span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>System::PackageName,User::PV_INPUT_DIRECTORY,User::PV_INPUT_EMPLOYEE_FILE_NAME,User::PV_INPUT_FOLDER<br/>
            </span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>//</span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>User::PV_INPUT_EMPLOYEE_FILE_PATH</span><br/>
            String Packagename = Dts.Variables[<span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>System::PackageName</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>].Value.ToString();<br/>
<br/>
            String InputDirectory </span>= Dts.Variables[<span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>User::PV_INPUT_DIRECTORY</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>].Value.ToString();<br/>
            String InputFolder </span>= Dts.Variables[<span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>User::PV_INPUT_FOLDER</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>].Value.ToString();<br/>
            String InputFileName </span>= Dts.Variables[<span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>User::PV_INPUT_EMPLOYEE_FILE_NAME</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>].Value.ToString();<br/>
<br/>
            String SInputFolder </span>=<span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> Path.Combine(InputDirectory,InputFolder);<br/>
            String SInputFilePath </span>=<span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> Path.Combine(SInputFolder,InputFileName);<br/>
            </span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>try</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'><br/>
            {<br/>
                </span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>//</span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> Check input directory</span><br/>
                <span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>if</span> (!<span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>Directory.Exists(InputDirectory))<br/>
                {<br/>
                    Dts.Events.FireError(</span><span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span>,Packagename,<span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>Input Directory: </span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span>+InputDirectory +<span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> doesn\'t exist!</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span>,<span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>""</span>,<span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>);<br/>
                    Dts.TaskResult </span>= (<span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>int</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>)ScriptResults.Failure;<br/>
                    </span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>return</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>;<br/>
                }<br/>
               <br/>
                </span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>//</span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> Check input folder</span><br/>
                <span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>if</span> (!<span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>Directory.Exists(SInputFolder))<br/>
                {<br/>
                    Dts.Events.FireError(</span><span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span>, Packagename, <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>Input Folder: </span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span> + SInputFolder + <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> doesn\'t exist!</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span>, <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>""</span>, <span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>);<br/>
                    Dts.TaskResult </span>= (<span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>int</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>)ScriptResults.Failure;<br/>
                    </span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>return</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>;<br/>
                }<br/>
<br/>
                </span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>//</span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> Check file path</span><br/>
                <span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>if</span> (!<span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>File.Exists(SInputFilePath))<br/>
                {<br/>
                    Dts.Events.FireError(</span><span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span>, Packagename, <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>Input file path: </span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span> + SInputFilePath+ <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> doesn\'t exist!</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span>, <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>""</span>, <span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>);<br/>
                    Dts.TaskResult </span>= (<span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>int</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>)ScriptResults.Failure;<br/>
                    </span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>return</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>;<br/>
                }<br/>
<br/>
                Dts.Variables[</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>User::PV_INPUT_EMPLOYEE_FILE_PATH</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span>].Value =<span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> SInputFilePath;<br/>
            }<br/>
            </span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>catch</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> (System.Exception e)<br/>
            {<br/>
                Dts.Events.FireError(</span><span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span>, Packagename, <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>Exception occured when checking the file directory or path with error: </span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span> + e.Message.ToString(), <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>""</span>, <span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>);<br/>
            }<br/>
<br/>
   Dts.TaskResult </span>= (<span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>int</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>)ScriptResults.Success;<br/>
  }</span></span></code></pre><p style="margin-left: auto;">保存 Script Task 并新建一个控制流任务并加载文件数据到指定的测试表中。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041626037063173.png"/></p><p>选中 Connection Manager 中的文件链接管理器，我们要将 PV_INPUT_EMPLOYEE_FILE_PATH 变量的值赋值给这个链接管理器中的文件链接字符串。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041626204419785.png"/></p><p>属性 ConnectionString 的赋值为 PV_INPUT_EMPLOYEE_FILE_PATH 。这样文件链接的字符串将根据 PV_INPUT_EMPLOYEE_FILE_PATH  变量的变化而变化了，这样文件路径就是可配置的了。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041626336918567.png"/></p><p>测试整个包，看看成功执行的效果。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041626399563914.png"/></p><p>数据是入库的。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041626468316847.png"/></p><p>下面分别修改 INPUT DIRECTORY, FOLDER 以及 FILE NAME 变量，看看验证的效果。</p><p>INPUT_DRECTORYTEST 这个目录不存在。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041626570818112.png"/><img alt="" src="file:///C:/Users/Administrator/AppData/Local/YNote/data/biwork@126.com/244252fa9bf04f538d24f5e1eeb9981b/clipboard.png"/></p><p>执行发生失败。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041627048164176.png"/></p><p>错误的信息非常清晰明显的指出了路径不存在！</p><p><span style="color: rgb(255, 0, 0);">[022_SCRIPT_VALIDATION] Error: Input Directory: D:\\BIWORKSPACE_FILE\\TS_BIWORK_SSIS\\INPUT_DIRECTORYTEST doesn\'t exist!</span></p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041627108941467.png"/></p><p>同样的测试发生在 INPUT FOLDER 和 INPUT FILE NAME 上就是，依次修改这两个变量为错误的值。</p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041627316447539.png"/></p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041628061915493.png"/></p><p>实际上，在上面的代码中可以只保留对 FILE PATH 的验证，因为 FILE PATH 的组成也是由 DIRECTORY 和 FOLDER 来组成的。</p><pre><code><span style='font-family: "Microsoft YaHei"; line-height: 1.5 !important;'>  <span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>//</span><span style='color: rgb(0, 128, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> Check file path</span><br/>
                <span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>if</span> (!<span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>File.Exists(SInputFilePath))<br/>
                {<br/>
                    Dts.Events.FireError(</span><span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span>, Packagename, <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>Input file path: </span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span> + SInputFilePath+ <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'> doesn\'t exist!</span><span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>"</span>, <span style='color: rgb(128, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>""</span>, <span style='color: rgb(128, 0, 128); font-family: "Courier New" !important; line-height: 1.5 !important;'>0</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>);<br/>
                    Dts.TaskResult </span>= (<span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>int</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>)ScriptResults.Failure;<br/>
                    </span><span style='color: rgb(0, 0, 255); font-family: "Courier New" !important; line-height: 1.5 !important;'>return</span><span style='color: rgb(0, 0, 0); font-family: "Courier New" !important; line-height: 1.5 !important;'>;<br/>
                }</span></span></code></pre><p style="margin-left: auto;">比如故意将 INPUT DIRECTORY 设置错误，放弃对INPUT DIRECTORY 和 FOLDER 的验证，那么整个文件的路径还是找不到的，因此只需要保留对文件路径最终的验证就可以了。</p><p><span style="color: rgb(255, 0, 0);">[022_SCRIPT_VALIDATION] Error: Input file path: D:\\BIWORKSPACE_FILE\\TS_BIWORK_SSIS\\INPUT_DIRECTORY1\\022\\EMPLOYEES.txt doesn\'t exist!</span></p><p><img alt="" src="http://images.cnitblog.com/blog/477275/201410/041629063622109.png"/></p><p>但是，在一个比较完整的 ETL 项目中，我们的验证应该是逐层的。特别是当源文件有很多的时候，我们的验证还是应该从主目录，目录到文件逐步验证。这样的信息更加准确一些和细致，对于我们的错误监控更加有利一些！</p>
</div>]
</body>
</html>
